# 星际战机 - 游戏存档功能说明

## 功能概述

游戏存档功能为星际战机游戏添加了完整的游戏记录管理系统，可以自动保存每次游戏的详细数据，并提供丰富的统计分析和数据管理功能。

## 主要特性

### 1. 自动存档
- **自动保存**：每次游戏结束时自动保存游戏记录
- **详细数据**：记录分数、击杀数、存活时间、命中率、连击数等详细信息
- **游戏设置**：保存游戏难度、获得的成就等信息
- **时间戳**：记录游戏的具体日期和时间

### 2. 数据统计
- **基础统计**：总游戏数、总游戏时间、平均分数、最高分数等
- **进阶统计**：命中率、连击记录、每分钟击杀数、每分钟得分等
- **趋势分析**：分析最近游戏表现的进步趋势
- **难度分析**：按不同难度统计游戏表现
- **时间分析**：分析最喜欢的游戏时间段

### 3. 数据管理
- **导出功能**：将游戏记录导出为JSON文件
- **导入功能**：从JSON文件导入游戏记录
- **搜索过滤**：按日期、难度、分数等条件搜索记录
- **数据清理**：清空所有记录或删除特定记录

## 使用方法

### 查看游戏记录
1. 在主菜单点击"游戏记录"按钮
2. 查看统计概览，包括各种游戏数据
3. 浏览最近的游戏记录列表
4. 查看不同难度的游戏统计

### 导出游戏记录
1. 在游戏记录界面点击"导出记录"按钮
2. 系统会自动下载一个JSON格式的存档文件
3. 文件名格式：`星际战机存档_YYYY-MM-DD.json`

### 导入游戏记录
1. 在游戏记录界面点击"导入记录"按钮
2. 选择之前导出的JSON存档文件
3. 系统会自动合并记录，避免重复导入

### 清空记录
1. 在游戏记录界面点击"清空记录"按钮
2. 确认操作后，所有游戏记录将被永久删除

## 数据结构

### 游戏记录包含的信息
```javascript
{
    id: 时间戳ID,
    timestamp: ISO时间戳,
    date: 游戏日期,
    time: 游戏时间,
    score: 最终分数,
    highScore: 当时的最高分,
    level: 达到的等级,
    kills: 击杀数,
    survivalTime: 存活时间(毫秒),
    totalShots: 总射击数,
    totalHits: 命中数,
    accuracy: 命中率(%),
    maxCombo: 最高连击数,
    difficulty: 游戏难度,
    achievements: 获得的成就列表,
    endReason: 游戏结束原因,
    playerLives: 剩余生命数,
    // 计算字段
    survivalTimeFormatted: 格式化的存活时间,
    killsPerMinute: 每分钟击杀数,
    scorePerMinute: 每分钟得分
}
```

### 统计数据包含的信息
- 总游戏数、总游戏时间、总分数、总击杀数
- 平均分数、平均击杀数、平均存活时间、平均命中率
- 最高分数、最多击杀、最长存活、最高连击
- 按难度分组的统计数据
- 游戏趋势分析（进步中/下降中/稳定）
- 游戏习惯分析（最喜欢的游戏时间段）

## 技术实现

### 存储机制
- 使用浏览器的 `localStorage` 进行本地存储
- 数据以JSON格式存储，支持复杂数据结构
- 自动处理存储异常和数据恢复

### 数据限制
- 最多保存100条游戏记录
- 超出限制时自动删除最旧的记录
- 支持手动清理和管理存储空间

### 兼容性
- 支持所有现代浏览器
- 数据格式向前兼容
- 支持版本升级和数据迁移

## 高级功能

### 搜索和过滤
```javascript
// 按难度过滤
recordManager.searchRecords({ difficulty: 'hard' });

// 按分数范围过滤
recordManager.searchRecords({ minScore: 2000, maxScore: 5000 });

// 按日期范围过滤
recordManager.searchRecords({ 
    startDate: '2024-01-01', 
    endDate: '2024-12-31' 
});

// 按成就过滤
recordManager.searchRecords({ hasAchievement: 'combo50' });

// 排序
recordManager.searchRecords({ 
    sortBy: 'score', 
    sortOrder: 'desc' 
});
```

### 数据分析
- **进步率计算**：比较前5局和后5局的平均分数
- **趋势分析**：分析最近表现是否在进步
- **时间分析**：统计不同时间段的游戏频率
- **效率分析**：计算每分钟击杀数和得分效率

## 注意事项

### 数据安全
- 游戏记录存储在本地浏览器中
- 清除浏览器数据会丢失所有记录
- 建议定期导出备份重要记录

### 性能考虑
- 记录数量限制在100条以内
- 大量数据时可能影响游戏启动速度
- 建议定期清理不需要的记录

### 隐私保护
- 所有数据仅存储在本地
- 不会上传到任何服务器
- 用户完全控制自己的游戏数据

## 故障排除

### 常见问题
1. **记录没有保存**：检查浏览器是否支持localStorage
2. **导出失败**：检查浏览器下载权限设置
3. **导入失败**：确认文件格式正确，检查文件是否损坏
4. **数据丢失**：检查是否清除了浏览器数据

### 数据恢复
如果数据意外丢失：
1. 检查浏览器的回收站或下载历史
2. 查找之前导出的备份文件
3. 使用导入功能恢复数据

## 开发者信息

### API接口
游戏记录管理器提供完整的API接口：
- `addGameRecord(gameData)` - 添加游戏记录
- `getAllRecords()` - 获取所有记录
- `getStatistics()` - 获取统计数据
- `exportRecords()` - 导出记录
- `importRecords(jsonData)` - 导入记录
- `searchRecords(filters)` - 搜索记录
- `clearAllRecords()` - 清空记录

### 扩展开发
开发者可以基于现有API扩展更多功能：
- 添加新的统计指标
- 实现云端同步功能
- 添加数据可视化图表
- 实现社交分享功能

## 更新日志

### v1.0.0 (2024-01-XX)
- 初始版本发布
- 基础存档功能
- 统计分析功能
- 导入导出功能
- 搜索过滤功能

---

*如有问题或建议，请联系开发团队。* 